Filesentry checking routine:

Database contains file hash entries for every file in the specified folders

Table "file_hashes" contains a file_found int flag

Before iterating the directories:
    set every file_found value in every record to 0

Iterate through each directory in the list one at a time ("do the walk")

For each regular file, hash the full path name (file_path_hash) and bits (file_bit_hash)

Search for the file_path_hash in the database

    If found:
        {check the file_bit_hash in the database against the hash generated by the walk
        do nothing specific if it matches
        if it does not match:
            set the flag_as_changed field to 1
        }
    If not found:
        {// this file is new or renamed since the last walk
        update the database with the file hash info
        flag_as_changed should be set to 1
        }
    Finally, set the file_found field to 1
    
When the walk has completed:

    {Find all records where file_found = 0
     // i.e. find the entries whose corresponding files no longer exist
     insert those records into the stale_hashes table
     delete them from the file_hashes table
     }
     
    {Find all records where flag_as_changed = 1
    Write those records into a text file
    email the text file to the specified location
    Put them into a zip file with the scan date and time
    Encrypt and password protect the zip file
    }
    
        
        